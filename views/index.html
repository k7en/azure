<!doctype html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
    integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <title>get-ms-graph-token</title>
</head>

<body>
  <div class="container">
    <h1>get-ms-graph-token</h1>
    <h2>signin / signout</h2>
    <p>
      <ul>
        <li><a href="/auth/signin">signin</a></li>
        <li><a href="/auth/signout">signout</a></li>
      </ul>
    </p>
    <% if(user){ %>
    <h3>access_token</h3>
    <p><textarea class="form-control" rows="5" disabled><%= user.access_token %></textarea></p>
    <h3>refresh_token</h3>
    <p><textarea class="form-control" rows="5" disabled><%= user.refresh_token %></textarea></p>
    <h3>profile</h3>
    <p>
      <dl class="row">
        <% for(const key of Object.keys(user.profile._json)){ %>
        <% const value = user.profile._json[key]; %>
        <dt class="col-sm-3"><%= key %></dt>
        <dd class="col-sm-9"><%= value %></dd>
        <% } %>
      </dl>
    </p>
    <% } %>
  </div>
</body>

</html>